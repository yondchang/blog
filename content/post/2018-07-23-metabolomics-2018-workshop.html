---
title: metabolomics 2018 workshop
author: Dabao Zhang and Min Zhang
date: '2018-07-23'
slug: metabolomics-2018-workshop
categories: []
tags: []
---



<p>This tutorial is based on workshop by Min Zhang and Dabao Zhang <a href="http://www.stat.purdue.edu/~zhangdb/packages/POCRE/" class="uri">http://www.stat.purdue.edu/~zhangdb/packages/POCRE/</a></p>
<p>knitr::opts_chunk$get(‘fig.path’)</p>
<pre class="r"><code>mbd &lt;- read.table(&quot;metabdata.csv&quot;,header=T,sep=&quot;,&quot;)
summary(mbd)</code></pre>
<pre><code>##    Diagnosis       Age        Gender      BMI        Smoking  Alcohol 
##  Healthy:58   Min.   :48.00   F:49   Min.   :18.30   No :55   No :30  
##  Polyps :44   1st Qu.:56.00   M:53   1st Qu.:24.25   Yes:47   Yes:72  
##               Median :61.00          Median :27.04                    
##               Mean   :60.85          Mean   :28.40                    
##               3rd Qu.:66.00          3rd Qu.:32.35                    
##               Max.   :72.00          Max.   :47.93                    
##     Formate         Histidine       Phenylalanine       Tyrosine     
##  Min.   : 1.017   Min.   :  5.985   Min.   : 41.08   Min.   : 12.80  
##  1st Qu.: 4.867   1st Qu.: 84.514   1st Qu.: 84.60   1st Qu.: 49.53  
##  Median : 7.489   Median :105.250   Median :100.92   Median : 58.59  
##  Mean   : 8.279   Mean   :101.397   Mean   :110.94   Mean   : 59.07  
##  3rd Qu.:10.797   3rd Qu.:121.240   3rd Qu.:123.93   3rd Qu.: 68.52  
##  Max.   :21.445   Max.   :162.402   Max.   :271.76   Max.   :117.47  
##       Urea         Unsaturate.Lipids    Glucose         Threonine     
##  Min.   : -1.551   Min.   : 897.5    Min.   : 678.7   Min.   : 383.1  
##  1st Qu.:118.635   1st Qu.:1739.5    1st Qu.:1449.2   1st Qu.: 511.8  
##  Median :166.059   Median :2189.4    Median :1705.5   Median : 550.8  
##  Mean   :175.758   Mean   :2266.4    Mean   :1655.8   Mean   : 560.8  
##  3rd Qu.:214.147   3rd Qu.:2744.6    3rd Qu.:1861.8   3rd Qu.: 597.5  
##  Max.   :522.694   Max.   :4126.6    Max.   :2345.0   Max.   :1282.7  
##     Lactate         Creatinine        Glycine      Choline.Phosphocholine
##  Min.   : 354.6   Min.   : 75.11   Min.   :142.9   Min.   :1179          
##  1st Qu.: 474.3   1st Qu.:106.67   1st Qu.:254.5   1st Qu.:2121          
##  Median : 552.3   Median :117.29   Median :300.9   Median :2748          
##  Mean   : 568.6   Mean   :126.03   Mean   :304.4   Mean   :2689          
##  3rd Qu.: 647.2   3rd Qu.:138.87   3rd Qu.:357.9   3rd Qu.:3246          
##  Max.   :1018.4   Max.   :387.14   Max.   :497.1   Max.   :4317          
##      Lysine      Dimethylglycine   Citric.acid       Glutamine     
##  Min.   :236.2   Min.   : 28.68   Min.   : 96.66   Min.   : 406.3  
##  1st Qu.:409.0   1st Qu.: 51.49   1st Qu.:195.34   1st Qu.: 771.8  
##  Median :482.2   Median : 61.48   Median :237.22   Median :1042.6  
##  Mean   :475.1   Mean   : 60.75   Mean   :245.32   Mean   : 993.6  
##  3rd Qu.:547.5   3rd Qu.: 70.32   3rd Qu.:286.97   3rd Qu.:1200.6  
##  Max.   :648.0   Max.   :107.72   Max.   :497.25   Max.   :1799.2  
##  Glutamic.acid     Acetoacetate      Acetone        Acetic.acid    
##  Min.   : 250.4   Min.   :119.5   Min.   : 144.3   Min.   : 88.16  
##  1st Qu.: 357.0   1st Qu.:152.8   1st Qu.: 295.7   1st Qu.:124.85  
##  Median : 409.6   Median :182.9   Median : 367.5   Median :142.46  
##  Mean   : 423.0   Mean   :206.7   Mean   : 406.0   Mean   :141.77  
##  3rd Qu.: 465.3   3rd Qu.:233.6   3rd Qu.: 485.1   3rd Qu.:158.41  
##  Max.   :1194.0   Max.   :750.4   Max.   :1487.7   Max.   :210.68  
##     Alanine       X3.hydroxybutyric.acid     Valine        Isoleucine    
##  Min.   : 824.7   Min.   : 366.1         Min.   :324.4   Min.   : 86.74  
##  1st Qu.:1206.8   1st Qu.: 556.6         1st Qu.:449.6   1st Qu.:109.36  
##  Median :1371.0   Median : 711.5         Median :506.1   Median :118.72  
##  Mean   :1359.4   Mean   : 769.7         Mean   :519.8   Mean   :124.04  
##  3rd Qu.:1528.0   3rd Qu.: 856.9         3rd Qu.:578.9   3rd Qu.:137.18  
##  Max.   :1887.7   Max.   :2965.0         Max.   :857.2   Max.   :205.89</code></pre>
<pre class="r"><code>plot(nspca &lt;- prcomp(mbd[,7:30], scale. = F))</code></pre>
<p><img src="/post/2018-07-23-metabolomics-2018-workshop_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>plot(scpca &lt;- prcomp(mbd[,7:30], scale. = T))</code></pre>
<p><img src="/post/2018-07-23-metabolomics-2018-workshop_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<pre class="r"><code>summary(nspca)</code></pre>
<pre><code>## Importance of components%s:
##                              PC1      PC2       PC3       PC4       PC5
## Standard deviation     1065.3469 457.9826 382.90640 222.07932 152.25772
## Proportion of Variance    0.6993   0.1292   0.09033   0.03039   0.01428
## Cumulative Proportion     0.6993   0.8285   0.91884   0.94922   0.96351
##                             PC6       PC7     PC8      PC9     PC10
## Standard deviation     125.4712 107.15810 91.8809 78.44530 65.92114
## Proportion of Variance   0.0097   0.00707  0.0052  0.00379  0.00268
## Cumulative Proportion    0.9732   0.98028  0.9855  0.98927  0.99195
##                            PC11     PC12     PC13     PC14    PC15
## Standard deviation     59.37011 56.58234 39.11030 37.23575 31.2844
## Proportion of Variance  0.00217  0.00197  0.00094  0.00085  0.0006
## Cumulative Proportion   0.99412  0.99610  0.99704  0.99789  0.9985
##                            PC16     PC17    PC18     PC19    PC20    PC21
## Standard deviation     28.91335 24.39339 22.2082 15.81130 9.90304 8.74750
## Proportion of Variance  0.00052  0.00037  0.0003  0.00015 0.00006 0.00005
## Cumulative Proportion   0.99901  0.99938  0.9997  0.99983 0.99990 0.99994
##                           PC22    PC23  PC24
## Standard deviation     7.40003 5.58324 2.754
## Proportion of Variance 0.00003 0.00002 0.000
## Cumulative Proportion  0.99998 1.00000 1.000</code></pre>
<pre class="r"><code>summary(scpca)</code></pre>
<pre><code>## Importance of components%s:
##                           PC1    PC2     PC3     PC4     PC5     PC6
## Standard deviation     3.2686 1.6868 1.29606 1.25153 1.19283 0.99726
## Proportion of Variance 0.4451 0.1186 0.06999 0.06526 0.05929 0.04144
## Cumulative Proportion  0.4451 0.5637 0.63368 0.69895 0.75823 0.79967
##                            PC7     PC8     PC9    PC10    PC11    PC12
## Standard deviation     0.91973 0.84353 0.79821 0.65413 0.60099 0.58972
## Proportion of Variance 0.03525 0.02965 0.02655 0.01783 0.01505 0.01449
## Cumulative Proportion  0.83492 0.86457 0.89111 0.90894 0.92399 0.93848
##                           PC13    PC14    PC15    PC16    PC17    PC18
## Standard deviation     0.52679 0.46454 0.43993 0.39572 0.38063 0.36281
## Proportion of Variance 0.01156 0.00899 0.00806 0.00652 0.00604 0.00548
## Cumulative Proportion  0.95004 0.95904 0.96710 0.97363 0.97966 0.98515
##                           PC19    PC20    PC21    PC22   PC23    PC24
## Standard deviation     0.30514 0.29954 0.27911 0.20862 0.2019 0.10699
## Proportion of Variance 0.00388 0.00374 0.00325 0.00181 0.0017 0.00048
## Cumulative Proportion  0.98903 0.99277 0.99601 0.99782 0.9995 1.00000</code></pre>
